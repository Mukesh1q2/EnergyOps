# ============================================================================
# OptiBid Energy Platform - Environment Configuration Template
# ============================================================================
# Copy this file to .env and update with your actual values
# This file documents all available configuration options
# ============================================================================

# ============================================================================
# REQUIRED SERVICES - These must be configured for the application to run
# ============================================================================

# ----------------------------------------------------------------------------
# Database Configuration (REQUIRED)
# ----------------------------------------------------------------------------
# PostgreSQL database connection string
# Format: postgresql+asyncpg://username:password@host:port/database
# The application REQUIRES PostgreSQL to function
# Default: postgresql+asyncpg://optibid:optibid_password@localhost:5432/optibid
DATABASE_URL=postgresql+asyncpg://optibid:optibid_password@localhost:5432/optibid

# ----------------------------------------------------------------------------
# Security Configuration (REQUIRED)
# ----------------------------------------------------------------------------
# Secret key for JWT token signing and encryption
# IMPORTANT: Change this to a strong random value in production
# Generate with: openssl rand -hex 32
SECRET_KEY=change-this-to-a-secure-random-key-in-production

# JWT algorithm for token signing
# Default: HS256
ALGORITHM=HS256

# JWT access token expiration time in minutes
# Default: 30 minutes
ACCESS_TOKEN_EXPIRE_MINUTES=30

# JWT refresh token expiration time in days
# Default: 7 days
REFRESH_TOKEN_EXPIRE_DAYS=7

# ----------------------------------------------------------------------------
# Application Configuration (REQUIRED)
# ----------------------------------------------------------------------------
# Application environment: development, staging, production
# Default: development
ENVIRONMENT=development

# Enable debug mode (set to false in production)
# Default: false
DEBUG=false

# Allowed hosts for CORS (comma-separated)
# Default: localhost,127.0.0.1,0.0.0.0
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0

# Base URL for the application (used for SSO callbacks, webhooks, etc.)
# Default: http://localhost:8000
BASE_URL=http://localhost:8000

# ============================================================================
# OPTIONAL SERVICES - These enhance functionality but are not required
# ============================================================================

# ----------------------------------------------------------------------------
# Redis Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# Redis is used for caching, session management, and WebSocket state
# If disabled, the application will use in-memory alternatives with reduced performance
# Default: false (disabled)
ENABLE_REDIS=false

# Redis connection URL
# Format: redis://[:password@]host:port/database
# Default: redis://localhost:6379/0
REDIS_URL=redis://localhost:6379/0

# ----------------------------------------------------------------------------
# Kafka Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# Kafka is used for real-time market data streaming
# If disabled, market data will be polled periodically instead
# Default: false (disabled)
ENABLE_KAFKA=false

# Kafka bootstrap servers (comma-separated)
# Default: localhost:9092
KAFKA_BOOTSTRAP_SERVERS=localhost:9092

# Kafka topic prefix for all OptiBid topics
# Default: optibid
KAFKA_TOPIC_PREFIX=optibid

# ----------------------------------------------------------------------------
# ClickHouse Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# ClickHouse is used for high-performance OLAP analytics
# If disabled, analytics features will be unavailable or use PostgreSQL
# Default: false (disabled)
ENABLE_CLICKHOUSE=false

# ClickHouse server host
# Default: localhost
CLICKHOUSE_HOST=localhost

# ClickHouse server port
# Default: 8123
CLICKHOUSE_PORT=8123

# ClickHouse username
# Default: default
CLICKHOUSE_USER=default

# ClickHouse password
# Default: (empty)
CLICKHOUSE_PASSWORD=

# ClickHouse database name
# Default: optibid_analytics
CLICKHOUSE_DATABASE=optibid_analytics

# ----------------------------------------------------------------------------
# MLflow Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# MLflow is used for ML model tracking and versioning
# If disabled, ML model management features will be unavailable
# Default: false (disabled)
ENABLE_MLFLOW=false

# MLflow tracking server URI
# Default: http://localhost:5000
MLFLOW_TRACKING_URI=http://localhost:5000

# MLflow experiment name
# Default: optibid_forecasting
MLFLOW_EXPERIMENT_NAME=optibid_forecasting

# Directory for storing ML models
# Default: ./models
MODELS_DIR=./models

# ----------------------------------------------------------------------------
# WebSocket Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# WebSocket enables real-time bidding and market data updates
# If disabled, clients will need to poll for updates
# Default: true (enabled)
ENABLE_WEBSOCKET=true

# ============================================================================
# FEATURE FLAGS - Control application behavior
# ============================================================================

# ----------------------------------------------------------------------------
# Simulation Mode (OPTIONAL)
# ----------------------------------------------------------------------------
# Enable market data simulation for development/testing
# Default: true (enabled in development)
SIMULATION_MODE=true

# Interval between simulated market data updates (seconds)
# Default: 5 seconds
SIMULATION_INTERVAL=5

# ============================================================================
# EXTERNAL SERVICES - Third-party integrations (all optional)
# ============================================================================

# ----------------------------------------------------------------------------
# Email Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# SMTP server for sending emails (notifications, password resets, etc.)
# If not configured, email features will be disabled
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
EMAIL_FROM=noreply@optibid.io

# ----------------------------------------------------------------------------
# Google Maps API (OPTIONAL)
# ----------------------------------------------------------------------------
# Used for geocoding and location-based features
# If not configured, location features will be limited
GOOGLE_MAPS_API_KEY=

# ----------------------------------------------------------------------------
# Market Data APIs (OPTIONAL)
# ----------------------------------------------------------------------------
# POSOCO (Power System Operation Corporation) API for Indian market data
POSOCO_API_URL=https://prl.iposoco.in/api
SLDC_API_KEY=

# Weather API for weather-based forecasting
WEATHER_API_KEY=

# Mapbox for advanced mapping features
MAPBOX_ACCESS_TOKEN=

# ----------------------------------------------------------------------------
# AI/ML Services (OPTIONAL)
# ----------------------------------------------------------------------------
# OpenAI API for advanced AI features
OPENAI_API_KEY=

# ----------------------------------------------------------------------------
# Single Sign-On (SSO) Configuration (OPTIONAL)
# ----------------------------------------------------------------------------
# Azure Active Directory SSO
AZURE_AD_CLIENT_ID=
AZURE_AD_CLIENT_SECRET=
AZURE_AD_TENANT_ID=

# Okta SSO
OKTA_CLIENT_ID=
OKTA_CLIENT_SECRET=
OKTA_ISSUER=

# Google Workspace SSO
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# SAML Enterprise SSO
SAML_CERTIFICATE=
SAML_PRIVATE_KEY=
SAML_ENTITY_ID=

# ----------------------------------------------------------------------------
# Multi-Factor Authentication (OPTIONAL)
# ----------------------------------------------------------------------------
# Twilio for SMS-based MFA
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# MFA issuer name (displayed in authenticator apps)
# Default: OptiBid Energy
MFA_ISSUER_NAME=OptiBid Energy

# Number of backup codes to generate
# Default: 10
MFA_BACKUP_CODES_COUNT=10

# MFA rate limiting
# Default: 5 attempts per 15 minutes
MFA_RATE_LIMIT_ATTEMPTS=5
MFA_RATE_LIMIT_WINDOW_MINUTES=15

# ----------------------------------------------------------------------------
# Cloud Storage & Backups (OPTIONAL)
# ----------------------------------------------------------------------------
# AWS S3 for backups and file storage
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
S3_BACKUP_BUCKET=
S3_BACKUP_REPLICATION_BUCKET=
AWS_BACKUP_ROLE_ARN=

# ----------------------------------------------------------------------------
# Payment Processing (OPTIONAL)
# ----------------------------------------------------------------------------
# Stripe payment processor
STRIPE_PUBLIC_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_API_VERSION=2023-10-16
STRIPE_CONNECT_MODE=false

# Razorpay payment processor (alternative to Stripe)
RAZORPAY_KEY_ID=
RAZORPAY_KEY_SECRET=
RAZORPAY_WEBHOOK_SECRET=

# ----------------------------------------------------------------------------
# Monitoring & Observability (OPTIONAL)
# ----------------------------------------------------------------------------
# Sentry for error tracking
SENTRY_DSN=

# Prometheus metrics
PROMETHEUS_ENABLED=false

# Grafana dashboards
GRAFANA_ENABLED=false

# ----------------------------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------------------------
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Development: DEBUG (all logs including detailed diagnostics)
# Staging: INFO (informational and above)
# Production: WARNING (warnings, errors, and critical only)
# Default: INFO
LOG_LEVEL=INFO

# Log directory for production file logging
# Default: /var/log/optibid
# Note: Ensure the application has write permissions to this directory
LOG_DIR=/var/log/optibid

# Log file rotation settings
# Maximum size per log file in bytes (default: 10MB)
LOG_FILE_MAX_BYTES=10485760

# Number of backup log files to keep (default: 10)
LOG_FILE_BACKUP_COUNT=10

# Security log backup count (default: 30 - keep more security logs)
SECURITY_LOG_BACKUP_COUNT=30

# Enable JSON structured logging (recommended for production)
# Default: true in production, false in development
LOG_JSON_FORMAT=true

# Enable log aggregation with ELK stack
# Default: false (enable in production with ELK stack)
LOG_AGGREGATION_ENABLED=false

# Elasticsearch host for log aggregation
# Default: elasticsearch:9200
ELASTICSEARCH_HOST=elasticsearch:9200

# Logstash host for log shipping
# Default: logstash:5000
LOGSTASH_HOST=logstash:5000

# Filebeat enabled for log shipping
# Default: false
FILEBEAT_ENABLED=false

# ============================================================================
# ADVANCED CONFIGURATION - Fine-tuning (optional)
# ============================================================================

# ----------------------------------------------------------------------------
# Session & Security Settings
# ----------------------------------------------------------------------------
# Session timeout in minutes
# Default: 30 minutes
SESSION_TIMEOUT_MINUTES=30

# Maximum concurrent sessions per user
# Default: 5
MAX_CONCURRENT_SESSIONS=5

# Trusted device duration in days
# Default: 30 days
TRUSTED_DEVICE_DAYS=30

# Security headers enabled
# Default: true
SECURITY_HEADERS_ENABLED=true

# HTTP Strict Transport Security max age (seconds)
# Default: 31536000 (1 year)
HSTS_MAX_AGE=31536000

# Content Security Policy enabled
# Default: true
CSP_ENABLED=true

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
# Enable rate limiting
# Default: true
RATE_LIMIT_ENABLED=true

# Rate limit storage backend: redis or memory
# Default: redis (falls back to memory if Redis unavailable)
RATE_LIMIT_STORAGE=redis

# Default rate limits
# Default: 1000 requests per hour
RATE_LIMIT_DEFAULT_LIMIT_PER_HOUR=1000

# Default: 10000 requests per day
RATE_LIMIT_DEFAULT_LIMIT_PER_DAY=10000

# Burst limit for short-term spikes
# Default: 100 requests
RATE_LIMIT_BURST_LIMIT=100

# Admin API rate limit
# Default: 10000 requests per hour
ADMIN_API_RATE_LIMIT_PER_HOUR=10000

# ----------------------------------------------------------------------------
# File Upload Configuration
# ----------------------------------------------------------------------------
# Directory for uploaded files
# Default: ./uploads
UPLOAD_DIR=./uploads

# Maximum file size in bytes
# Default: 104857600 (100MB)
MAX_FILE_SIZE=104857600

# ----------------------------------------------------------------------------
# Compliance & Audit
# ----------------------------------------------------------------------------
# Enable audit logging
# Default: true
AUDIT_LOG_ENABLED=true

# Audit log retention period (days)
# Default: 2555 (7 years for compliance)
AUDIT_LOG_RETENTION_DAYS=2555

# Encrypt audit logs
# Default: true
AUDIT_LOG_ENCRYPTED=true

# Audit log encryption key (generate with: openssl rand -hex 32)
AUDIT_LOG_ENCRYPTION_KEY=

# SOC2 compliance mode
# Default: false
SOC2_COMPLIANCE=false

# GDPR compliance mode
# Default: false
GDPR_COMPLIANCE=false

# Data retention period (days)
# Default: 2555 (7 years)
DATA_RETENTION_DAYS=2555

# ----------------------------------------------------------------------------
# Disaster Recovery
# ----------------------------------------------------------------------------
# Recovery Time Objective (minutes)
# Default: 120 (2 hours)
DR_RTO_MINUTES=120

# Recovery Point Objective (minutes)
# Default: 60 (1 hour)
DR_RPO_MINUTES=60

# Backup retention period (days)
# Default: 30
BACKUP_RETENTION_DAYS=30

# Enable cross-region replication
# Default: true
CROSS_REGION_REPLICATION=true

# ----------------------------------------------------------------------------
# Usage Tracking & Analytics
# ----------------------------------------------------------------------------
# Enable usage tracking
# Default: true
USAGE_TRACKING_ENABLED=true

# Usage data retention (days)
# Default: 90
USAGE_DATA_RETENTION_DAYS=90

# Usage cache TTL (seconds)
# Default: 3600 (1 hour)
USAGE_CACHE_TTL_SECONDS=3600

# Usage cleanup interval (hours)
# Default: 24
USAGE_CLEANUP_INTERVAL_HOURS=24

# Enable analytics
# Default: true
ANALYTICS_ENABLED=true

# Analytics data retention (days)
# Default: 365
ANALYTICS_DATA_RETENTION_DAYS=365

# Analytics cache TTL (hours)
# Default: 24
ANALYTICS_CACHE_TTL_HOURS=24

# ----------------------------------------------------------------------------
# Background Task Processing (Celery)
# ----------------------------------------------------------------------------
# Celery broker URL (uses Redis by default)
# Default: redis://localhost:6379/2
CELERY_BROKER_URL=redis://localhost:6379/2

# Celery result backend
# Default: redis://localhost:6379/3
CELERY_RESULT_BACKEND=redis://localhost:6379/3

# Celery task serializer
# Default: json
CELERY_TASK_SERIALIZER=json

# Celery timezone
# Default: UTC
CELERY_TIMEZONE=UTC

# ----------------------------------------------------------------------------
# Health Check Configuration
# ----------------------------------------------------------------------------
# Health check interval (seconds)
# Default: 60
HEALTH_CHECK_INTERVAL_SECONDS=60

# Health check timeout (seconds)
# Default: 30
HEALTH_CHECK_TIMEOUT_SECONDS=30

# Health check retention (days)
# Default: 30
HEALTH_CHECK_RETENTION_DAYS=30

# Alert threshold (consecutive failures)
# Default: 3
HEALTH_CHECK_ALERT_THRESHOLD=3

# ----------------------------------------------------------------------------
# Admin Panel Configuration
# ----------------------------------------------------------------------------
# Admin session timeout (hours)
# Default: 24
ADMIN_SESSION_TIMEOUT_HOURS=24

# Maximum users per organization
# Default: 100
ADMIN_MAX_USERS_PER_ORG=100

# Require email verification for new users
# Default: true
ADMIN_REQUIRE_EMAIL_VERIFICATION=true

# Allow self-registration
# Default: false
ADMIN_ALLOW_SELF_REGISTRATION=false

# Allowed email domains for registration (comma-separated)
# Default: (empty - all domains allowed)
ADMIN_ALLOWED_EMAIL_DOMAINS=

# ----------------------------------------------------------------------------
# Feature Flags Configuration
# ----------------------------------------------------------------------------
# Feature flags environment
# Default: production
FEATURE_FLAGS_ENVIRONMENT=production

# Feature rollout percentage (0-100)
# Default: 0 (disabled)
FEATURE_FLAGS_ROLLOUT_PERCENTAGE=0

# Feature flags cache TTL (seconds)
# Default: 300 (5 minutes)
FEATURE_FLAGS_CACHE_TTL=300

# ----------------------------------------------------------------------------
# API Documentation
# ----------------------------------------------------------------------------
# Enable API documentation
# Default: true
API_DOCS_ENABLED=true

# Swagger UI URL
# Default: /api/docs
API_DOCS_URL=/api/docs

# ReDoc URL
# Default: /api/redoc
REDOC_URL=/api/redoc

# OpenAPI JSON URL
# Default: /api/openapi.json
OPENAPI_URL=/api/openapi.json

# ----------------------------------------------------------------------------
# Organization Management
# ----------------------------------------------------------------------------
# Maximum organization name length
# Default: 255
ORG_NAME_MAX_LENGTH=255

# Maximum organization description length
# Default: 1000
ORG_DESCRIPTION_MAX_LENGTH=1000

# Organization settings cache TTL (seconds)
# Default: 1800 (30 minutes)
ORG_SETTINGS_CACHE_TTL=1800

# ----------------------------------------------------------------------------
# Quota Management
# ----------------------------------------------------------------------------
# Enable quota checking
# Default: true
QUOTA_CHECK_ENABLED=true

# Quota warning threshold (0.0-1.0)
# Default: 0.8 (80%)
QUOTA_WARNING_THRESHOLD=0.8

# Quota enforcement mode: soft or hard
# Default: soft
QUOTA_ENFORCEMENT_MODE=soft

# ----------------------------------------------------------------------------
# Edge/OT Integration (OPTIONAL)
# ----------------------------------------------------------------------------
# SCADA system endpoint
SCADA_ENDPOINT=

# RTU (Remote Terminal Unit) endpoint
RTU_ENDPOINT=

# PMU (Phasor Measurement Unit) endpoint
PMU_ENDPOINT=

# ----------------------------------------------------------------------------
# Webhook Configuration
# ----------------------------------------------------------------------------
# Webhook secret for signature verification
# Default: your-webhook-secret
WEBHOOK_SECRET=your-webhook-secret

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
#
# MINIMAL DEPLOYMENT (Development/Testing):
# - DATABASE_URL (PostgreSQL)
# - SECRET_KEY
# - All other services can remain disabled
#
# STANDARD DEPLOYMENT (Production):
# - DATABASE_URL (PostgreSQL) - REQUIRED
# - SECRET_KEY - REQUIRED
# - REDIS_URL + ENABLE_REDIS=true - RECOMMENDED for performance
# - ENABLE_WEBSOCKET=true - RECOMMENDED for real-time features
# - SMTP configuration - RECOMMENDED for notifications
# - Monitoring (Sentry, Prometheus) - RECOMMENDED
#
# FULL DEPLOYMENT (Enterprise):
# - All standard deployment services
# - KAFKA + ENABLE_KAFKA=true - for real-time streaming
# - CLICKHOUSE + ENABLE_CLICKHOUSE=true - for analytics
# - MLFLOW + ENABLE_MLFLOW=true - for ML features
# - SSO configuration - for enterprise authentication
# - AWS S3 - for backups and file storage
# - Payment processor (Stripe/Razorpay) - for billing
#
# ============================================================================
